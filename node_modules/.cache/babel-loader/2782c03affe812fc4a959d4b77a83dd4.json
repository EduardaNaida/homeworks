{"ast":null,"code":"import _slicedToArray from\"/Users/eduardanaida/Documents/GitHub/homeworks/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import s2 from'../../s1-main/App.module.css';import s from'./HW15.module.css';import axios from'axios';import SuperPagination from'./common/c9-SuperPagination/SuperPagination';import{useSearchParams}from'react-router-dom';import SuperSort from'./common/c10-SuperSort/SuperSort';/*\n* 1 - дописать SuperPagination\n* 2 - дописать SuperSort\n* 3 - проверить pureChange тестами\n* 3 - дописать sendQuery, onChangePagination, onChangeSort в HW15\n* 4 - сделать стили в соответствии с дизайном\n* 5 - добавить HW15 в HW5/pages/JuniorPlus\n* */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var getTechs=function getTechs(params){return axios.get('https://incubator-personal-page-back.herokuapp.com/api/3.0/homework/test3',{params:params}).catch(function(e){var _e$response,_e$response$data;alert(((_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.errorText)||e.message);});};var HW15=function HW15(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),sort=_useState2[0],setSort=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),page=_useState4[0],setPage=_useState4[1];var _useState5=useState(4),_useState6=_slicedToArray(_useState5,2),count=_useState6[0],setCount=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),idLoading=_useState8[0],setLoading=_useState8[1];var _useState9=useState(100),_useState10=_slicedToArray(_useState9,2),totalCount=_useState10[0],setTotalCount=_useState10[1];var _useSearchParams=useSearchParams(),_useSearchParams2=_slicedToArray(_useSearchParams,2),searchParams=_useSearchParams2[0],setSearchParams=_useSearchParams2[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),techs=_useState12[0],setTechs=_useState12[1];var sendQuery=function sendQuery(params){setLoading(true);getTechs(params).then(function(res){// делает студент\nif(res){setTechs(res.data.techs);setTotalCount(res.data.totalCount);setLoading(false);}// сохранить пришедшие данные\n//\n});};var onChangePagination=function onChangePagination(newPage,newCount){// делает студент\nsetPage(newPage);setCount(newCount);// const params = Object.fromEntries(searchParams)\n// sendQuery(params)\n// sendQuery({page: newPage, count: newCount})\nsetSearchParams({count:newCount.toString(),page:newPage.toString(),sort:sort});setLoading(false);};var onChangeSort=function onChangeSort(newSort){// делает студент\nsetSort(newSort);setPage(1);setSearchParams({count:count.toString(),page:page.toString(),sort:newSort});// const params = Object.fromEntries(searchParams)\n// sendQuery(params)\n};useEffect(function(){var params=Object.fromEntries(searchParams);sendQuery(params);},[searchParams]);useEffect(function(){var params=Object.fromEntries(searchParams);sendQuery({page:params.page,count:params.count});setPage(+params.page||1);setCount(+params.count||4);},[]);var mappedTechs=techs.map(function(t){return/*#__PURE__*/_jsxs(\"div\",{className:s.row,children:[/*#__PURE__*/_jsx(\"div\",{id:'hw15-tech-'+t.id,className:s.tech,children:t.tech}),/*#__PURE__*/_jsx(\"div\",{id:'hw15-developer-'+t.id,className:s.developer,children:t.developer})]},t.id);});return/*#__PURE__*/_jsxs(\"div\",{id:'hw15',children:[/*#__PURE__*/_jsx(\"div\",{className:s2.hwTitle,children:\"Homework #15\"}),/*#__PURE__*/_jsxs(\"div\",{className:s2.hw,children:[idLoading&&/*#__PURE__*/_jsx(\"div\",{id:'hw15-loading',className:s.loading,children:\"Loading...\"}),/*#__PURE__*/_jsx(SuperPagination,{page:page,itemsCountForPage:count,totalCount:totalCount,onChange:onChangePagination}),/*#__PURE__*/_jsxs(\"div\",{className:s.rowHeader,children:[/*#__PURE__*/_jsxs(\"div\",{className:s.techHeader,children:[\"tech\",/*#__PURE__*/_jsx(SuperSort,{sort:sort,value:'tech',onChange:onChangeSort})]}),/*#__PURE__*/_jsxs(\"div\",{className:s.developerHeader,children:[\"developer\",/*#__PURE__*/_jsx(SuperSort,{sort:sort,value:'developer',onChange:onChangeSort})]})]}),mappedTechs]})]});};export default HW15;","map":{"version":3,"names":["React","useEffect","useState","s2","s","axios","SuperPagination","useSearchParams","SuperSort","getTechs","params","get","catch","e","alert","response","data","errorText","message","HW15","sort","setSort","page","setPage","count","setCount","idLoading","setLoading","totalCount","setTotalCount","searchParams","setSearchParams","techs","setTechs","sendQuery","then","res","onChangePagination","newPage","newCount","toString","onChangeSort","newSort","Object","fromEntries","mappedTechs","map","t","row","id","tech","developer","hwTitle","hw","loading","rowHeader","techHeader","developerHeader"],"sources":["/Users/eduardanaida/Documents/GitHub/homeworks/src/s2-homeworks/hw15/HW15.tsx"],"sourcesContent":["import React, {useEffect, useState} from 'react'\nimport s2 from '../../s1-main/App.module.css'\nimport s from './HW15.module.css'\nimport axios from 'axios'\nimport SuperPagination from './common/c9-SuperPagination/SuperPagination'\nimport {useSearchParams} from 'react-router-dom'\nimport SuperSort from './common/c10-SuperSort/SuperSort'\n\n/*\n* 1 - дописать SuperPagination\n* 2 - дописать SuperSort\n* 3 - проверить pureChange тестами\n* 3 - дописать sendQuery, onChangePagination, onChangeSort в HW15\n* 4 - сделать стили в соответствии с дизайном\n* 5 - добавить HW15 в HW5/pages/JuniorPlus\n* */\n\ntype TechType = {\n    id: number\n    tech: string\n    developer: string\n}\n\ntype ParamsType = {\n    sort: string\n    page: number\n    count: number\n}\n\nconst getTechs = (params: ParamsType) => {\n    return axios\n        .get<{ techs: TechType[], totalCount: number }>(\n            'https://incubator-personal-page-back.herokuapp.com/api/3.0/homework/test3',\n            {params}\n        )\n        .catch((e) => {\n            alert(e.response?.data?.errorText || e.message)\n        })\n}\n\nconst HW15 = () => {\n    const [sort, setSort] = useState('')\n    const [page, setPage] = useState(1)\n    const [count, setCount] = useState(4)\n    const [idLoading, setLoading] = useState(false)\n    const [totalCount, setTotalCount] = useState(100)\n    const [searchParams, setSearchParams] = useSearchParams()\n    const [techs, setTechs] = useState<TechType[]>([])\n\n    const sendQuery = (params: any) => {\n        setLoading(true)\n        getTechs(params)\n            .then((res) => {\n                // делает студент\n                if (res) {\n                    setTechs(res.data.techs)\n                    setTotalCount(res.data.totalCount)\n                    setLoading(false)\n                }\n                // сохранить пришедшие данные\n\n                //\n            })\n    }\n\n    const onChangePagination = (newPage: number, newCount: number) => {\n        // делает студент\n        setPage(newPage)\n        setCount(newCount)\n        // const params = Object.fromEntries(searchParams)\n        // sendQuery(params)\n        // sendQuery({page: newPage, count: newCount})\n\n        setSearchParams({\n            count: newCount.toString(),\n            page: newPage.toString(),\n            sort: sort,\n        })\n        setLoading(false)\n\n    }\n\n    const onChangeSort = (newSort: string) => {\n        // делает студент\n        setSort(newSort)\n        setPage(1)\n\n        setSearchParams({\n            count: count.toString(),\n            page: page.toString(),\n            sort: newSort\n        })\n        // const params = Object.fromEntries(searchParams)\n        // sendQuery(params)\n    }\n\n    useEffect(() => {\n        const params = Object.fromEntries(searchParams)\n        sendQuery(params)\n    }, [searchParams])\n\n    useEffect(() => {\n        const params = Object.fromEntries(searchParams)\n        sendQuery({page: params.page, count: params.count})\n        setPage(+params.page || 1)\n        setCount(+params.count || 4)\n    }, [])\n\n    const mappedTechs = techs.map(t => (\n        <div key={t.id} className={s.row}>\n            <div id={'hw15-tech-' + t.id} className={s.tech}>\n                {t.tech}\n            </div>\n\n            <div id={'hw15-developer-' + t.id} className={s.developer}>\n                {t.developer}\n            </div>\n        </div>\n    ))\n\n    return (\n        <div id={'hw15'}>\n            <div className={s2.hwTitle}>Homework #15</div>\n\n            <div className={s2.hw}>\n                {idLoading && <div id={'hw15-loading'} className={s.loading}>Loading...</div>}\n\n                <SuperPagination\n                    page={page}\n                    itemsCountForPage={count}\n                    totalCount={totalCount}\n                    onChange={onChangePagination}\n                />\n\n                <div className={s.rowHeader}>\n                    <div className={s.techHeader}>\n                        tech\n                        <SuperSort sort={sort} value={'tech'} onChange={onChangeSort}/>\n                    </div>\n\n                    <div className={s.developerHeader}>\n                        developer\n                        <SuperSort sort={sort} value={'developer'} onChange={onChangeSort}/>\n                    </div>\n                </div>\n\n                {mappedTechs}\n            </div>\n        </div>\n    )\n}\n\nexport default HW15\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}